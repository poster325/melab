"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8520],{88520:function(e,n,r){r.r(n),r.d(n,{default:function(){return index_BestWorksSection}});var t=r(85893),i=r(93967),o=r.n(i),a=r(63672),s=r(67294),u=r(65912),l=r(40975),c=r(4960),v=r(48828),m=r(88459),d=r(40705),g=r(25675),f=r.n(g),p=r(79661),x=r(81047),h=r(74441),w=r(86306),P=r(99477),y=r(86701),S=r(10931),j=r(69034),L=r(57632),E=r(65021),_=r(32964);let b=new Map;var WebglProjectCard_WebglProjectCard=e=>{let{containerRef:n,img:r,video:i,scaleOuter:o,toner:a=0}=e,u=(0,s.useRef)(null),l=(0,s.useRef)(null),c=(0,s.useRef)(null),v=(0,j.D)(e=>e.size),m=(0,j.D)(e=>e.gl),d=(0,s.useMemo)(()=>new P.Vector2(n.current?.classList.contains("project-card--wide")?1.2881054329088584:.9177628834441138,1),[n]),g=(0,s.useMemo)(()=>{let e=`${d.x}/${d.y}`,n=b.get(e);if(n)return n;let r=new P.PlaneGeometry(d.x,d.y);return b.set(e,r),r},[d.x,d.y]),f=(0,y.mE)(r),p=(0,j.H)(!function(){let e=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),n=navigator.userAgent.indexOf("Firefox")>-1,r=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;return"undefined"==typeof createImageBitmap||e||n&&98>Number(r)}()?P.ImageBitmapLoader:P.ImageLoader,r,e=>(e instanceof P.ImageBitmapLoader&&e.setOptions({colorSpaceConversion:"none",premultiplyAlpha:"default",imageOrientation:"flipY"}),e)),x=(0,s.useMemo)(()=>p instanceof P.Texture?p:p instanceof ImageBitmap?new P.CanvasTexture(p):void 0,[p]);x.colorSpace=P.SRGBColorSpace,(0,s.useEffect)(()=>{m.initTexture(x)},[m,x]);let h=(0,S.y)(i,{unsuspend:"canplay",crossOrigin:"anonymous",muted:!0,loop:!0,autoplay:!0,start:!1}),w=(0,s.useMemo)(()=>({uTime:{value:0},uProgress:{value:0},uFlag:{value:0},uScrollProgress:{value:0},uPlaneSize:{value:d},uImage:{value:x},uImageSize:{value:new P.Vector2(f.image.naturalWidth,f.image.naturalHeight)},uVideo:{value:h},uVideoSize:{value:new P.Vector2(h.image.videoWidth,h.image.videoHeight)},uToner:{value:a},uResolution:{value:new P.Vector2(v.width,v.height)}}),[f,x,d,h,v.width,v.height,a]);return(0,s.useEffect)(()=>{c.current instanceof Promise?c.current.then(()=>{h.image.pause()}):h.image.pause()},[h.image]),(0,s.useEffect)(()=>{let{current:e}=n,onCanPlay=()=>{c.current=h.image.play().then(()=>{c.current=null})},onPointerOver=()=>{h.image instanceof HTMLVideoElement&&(h.image.currentTime=0,4===h.image.readyState?c.current=h.image.play().then(()=>{c.current=null}):h.image.addEventListener("canplay",onCanPlay,{once:!0}))},onPointerOut=()=>{h.image.removeEventListener("canplay",onCanPlay),c.current instanceof Promise?c.current.then(()=>{h.image.pause()}):h.image.pause()};return e&&(e.addEventListener("pointerenter",onPointerOver),e.addEventListener("pointerleave",onPointerOut)),()=>{e&&(e.removeEventListener("pointerenter",onPointerOver),e.removeEventListener("pointerleave",onPointerOut))}},[n,h.image]),(0,s.useEffect)(()=>{let{current:e}=n,onPointerEnter=()=>{l.current&&(l.current.uniforms.uFlag.value=Math.round(Math.random()),(0,E.j)(l.current.uniforms.uProgress.value,1,{duration:1.3,ease:_.w2,onUpdate:e=>{l.current&&(l.current.uniforms.uProgress.value=e)}}))},onPointerLeave=()=>{l.current&&(0,E.j)(l.current.uniforms.uProgress.value,0,{duration:1.3,ease:_.w2,onUpdate:e=>{l.current&&(l.current.uniforms.uProgress.value=e)}})};return e&&(e.addEventListener("pointerenter",onPointerEnter),e.addEventListener("pointerleave",onPointerLeave)),()=>{e&&(e.removeEventListener("pointerenter",onPointerEnter),e.removeEventListener("pointerleave",onPointerLeave))}},[n]),(0,j.F)(e=>{let{clock:n}=e;if(u.current){let e=o.get();u.current.scale.set(e,e,e)}l.current&&(l.current.uniforms.uTime.value=n.getElapsedTime())}),(0,t.jsx)("mesh",{ref:u,position:[0,0,-2.8],geometry:g,children:(0,t.jsx)("shaderMaterial",{ref:l,uniforms:w,vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n}\n",fragmentShader:"#define GLSLIFY 1\nvec2 coverTextureUv(vec2 imgSize, vec2 planeSize, vec2 ouv) {\n    vec2 s = planeSize;\n    vec2 i = imgSize;\n    float rs = s.x / s.y;\n    float ri = i.x / i.y;\n    vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n    vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n    vec2 uv = ouv * s / new + offset;\n\n    return uv;\n}\n\nvarying vec2 vUv;\n\nuniform float uFlag;\nuniform float uProgress;\nuniform vec2 uResolution;\nuniform vec2 uPlaneSize;\nuniform sampler2D uImage;\nuniform vec2 uImageSize;\nuniform vec2 uVideoSize;\nuniform sampler2D uVideo;\nuniform float uToner;\n\nvec4 toLinearSRGB(vec4 color) {\n    return vec4(mix(pow(color.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), color.rgb * 0.0773993808, vec3(lessThanEqual(color.rgb, vec3(0.04045)))), color.w);\n}\n\nconst float uBorderRadius = 20.0;\n\nfloat calcDistance(vec2 uv) {\n    vec2 positionInQuadrant = abs(uv * 2.0 - 1.0);\n    vec2 extend = uResolution / 2.0;\n    vec2 coords = positionInQuadrant * (extend + uBorderRadius);\n    vec2 delta = max(coords - extend, 0.);\n    return length(delta);\n}\n\nvoid main() {\n    vec2 uv = vUv;\n\n    if (calcDistance(uv) > uBorderRadius) {\n        discard;\n    }\n\n    vec2 cUv = coverTextureUv(uImageSize, uPlaneSize, uv);\n    vec2 videoUv = coverTextureUv(uVideoSize, uPlaneSize, uv);\n    float x = uProgress;\n    float xx = uFlag == 0. ? x : 1. - x;\n    float s = smoothstep(0., 1., (xx * 2.0 + (cUv.x) - 1.0));\n    x = uFlag == 0. ? s : 1. - s;\n    vec4 imgColor = texture2D(uImage, cUv - .5 * (1. - x) + .5);\n    vec4 videoColor = toLinearSRGB(texture2D(uVideo, videoUv - .5 * x + .5));\n    vec4 color = mix(imgColor, videoColor, clamp(0., 1., x));\n    color.rgb *= 1. - uToner;\n\n    gl_FragColor = color;\n    #include <tonemapping_fragment>\n    #include <colorspace_fragment>\n}\n"},(0,L.Z)())})},T=r(25570),z=r(76305),C=r(4511),I=r(41910);let ProjectsListItem=e=>{let{work:n,scaleOuter:r,toner:i=.12}=e,a=(0,s.useRef)(null),u=(0,s.useRef)(null),[l]=(0,z.zY)(),[c,v]=(0,s.useState)(""),m=(0,p.ac)("(hover: hover) and (pointer: fine)"),g=n.video?.[0]?.src||"",h=(0,p.tm)(),w=h()&&"desktop"===l&&m&&!!c&&!!g;return(0,s.useEffect)(()=>{let e=setTimeout(()=>{if(a.current){let e=a.current.querySelector("img.js-image");e&&(e.complete?v(e.currentSrc):e.addEventListener("load",()=>{v(e.currentSrc)},{once:!0}))}},100);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{u.current&&v(u.current.currentSrc)},[]),(0,t.jsxs)("li",{className:o()("projects-list__item",{"projects-list__item--narrow":"vertical"===n.position}),children:[(0,t.jsx)(x.Z,{ref:a,imageRef:u,slug:n.slug,image:n.image??void 0,video:n.video,additionalImages:n.additionalImages,isNew:"new"===n.status,inProgress:"in_progress"===n.status,isOnline:"online"===n.status,isConcept:"concept"===n.status,types:Array.isArray(n.types)?n.types.map(e=>e.name):[],title:n.title,wide:"horizont"===n.position,awards:n.awards,scaleOuter:"desktop"===l?r:void 0,className:o()({"webgl-initialized":w}),useWebgl:w,toner:i}),n.image?.src&&w&&(0,t.jsx)(C.SV,{fallback:(0,t.jsx)(f(),{src:n.image.src,width:n.image.width,height:n.image.height,className:"responsive__item",alt:n.title,sizes:"horizont"===n.position?"(max-width: 1199px) 100vw, 70vw":"(max-width: 1199px) 64vw, 55vw"}),onError:e=>{(0,I.Tb)(e)},children:(0,t.jsx)(s.Suspense,{children:(0,t.jsx)(T.T.In,{children:(0,t.jsx)(d.G,{track:a,children:(0,t.jsx)(WebglProjectCard_WebglProjectCard,{containerRef:a,img:c,video:g,scaleOuter:r,toner:i})})})})})]},n.id)};var k=(0,s.memo)(e=>{let{projects:n=[],...r}=e,{scrollY:i}=(0,u.v)(),a=(0,l.T)(i),s=(0,c.c)(0),d=(0,v.H)(s,e=>1-("number"==typeof e?e:0));return(0,m.p)(()=>{s.set((0,h.t)(s.get(),Math.abs(.15*a.get()*(1/w.P.width)),.065))}),(0,t.jsx)("ul",{...r,className:o()("list-unstyled projects-list",r.className),children:n.map(e=>(0,t.jsx)(ProjectsListItem,{work:e,scaleOuter:d},e.id))})}),R=r(87739),O=r(41079),U=r(82215),N=r(74917),index_BestWorksSection=e=>{let{works:n,title:r,...i}=e,[s]=(0,O.CH)(),u=(0,N.b)(),l="cases";return(0,t.jsxs)("section",{...i,className:o()("section section--with-all-link best-works-section wrapper",i.className),id:l,"data-navigation-section":l,children:[(0,t.jsx)(a.Z,{href:"/works",className:"section__all-link link link--underlined",children:U.l.ALL_CASES[u]}),r&&(0,t.jsx)("h2",{className:"section__title best-works-section__title",children:(0,t.jsx)(R.Z,{stagger:.04,delay:.1,allowed:s,children:r})}),(0,t.jsx)(k,{projects:n})]})}},25570:function(e,n,r){r.d(n,{T:function(){return i}});var t=r(85470);let i=(0,t.Z)()}}]);